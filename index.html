<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Schedule Optimizer ‚Ä¢ Gemini</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #0b0f19; min-height: 100vh; color: #fff; overflow-x: hidden; }
        
        /* –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω */
        .bg-gradient { position: fixed; border-radius: 50%; filter: blur(100px); z-index: -1; }
        .bg-1 { width: 600px; height: 600px; background: linear-gradient(135deg, #4285f4 0%, #34a853 100%); top: -200px; left: -100px; opacity: 0.2; }
        .bg-2 { width: 500px; height: 500px; background: linear-gradient(135deg, #fbbc04 0%, #ea4335 100%); bottom: -150px; right: -100px; opacity: 0.2; }
        .bg-3 { width: 400px; height: 400px; background: linear-gradient(135deg, #4285f4 0%, #34a853 100%); top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0.15; }
        
        /* Navbar */
        .navbar { position: sticky; top: 0; z-index: 100; background: rgba(11,15,25,0.9); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255,255,255,0.08); padding: 0 20px; }
        .navbar-inner { max-width: 1500px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; height: 60px; }
        .nav-logo { font-size: 1.2rem; font-weight: 700; display: flex; align-items: center; gap: 10px; }
        .gemini-icon { width: 32px; height: 32px; background: linear-gradient(135deg, #4285f4, #34a853, #fbbc04, #ea4335); border-radius: 50%; }
        .burger { display: flex; flex-direction: column; justify-content: center; gap: 5px; width: 36px; height: 36px; cursor: pointer; padding: 4px; border-radius: 8px; transition: background 0.2s; }
        .burger:hover { background: rgba(255,255,255,0.08); }
        .burger span { display: block; height: 2px; border-radius: 2px; background: rgba(255,255,255,0.8); transition: all 0.3s; }
        .burger.active span:nth-child(1) { transform: translateY(7px) rotate(45deg); }
        .burger.active span:nth-child(2) { opacity: 0; }
        .burger.active span:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }
        
        /* Sidebar */
        .sidebar-overlay { position: fixed; inset: 0; z-index: 200; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); opacity: 0; pointer-events: none; transition: opacity 0.3s; }
        .sidebar-overlay.open { opacity: 1; pointer-events: all; }
        .sidebar { position: fixed; top: 0; right: -320px; bottom: 0; width: 320px; z-index: 201; background: rgba(15,20,35,0.98); backdrop-filter: blur(20px); border-left: 1px solid rgba(255,255,255,0.1); transition: right 0.35s cubic-bezier(.4,0,.2,1); display: flex; flex-direction: column; }
        .sidebar.open { right: 0; }
        .sidebar-header { padding: 20px; border-bottom: 1px solid rgba(255,255,255,0.08); display: flex; align-items: center; gap: 12px; }
        .sidebar-header .gemini-icon { width: 40px; height: 40px; }
        .sidebar-title { font-size: 1.1rem; font-weight: 700; }
        .sidebar-close { width: 32px; height: 32px; border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer; color: rgba(255,255,255,0.5); font-size: 1.3rem; transition: all 0.2s; margin-left: auto; }
        .sidebar-close:hover { background: rgba(255,255,255,0.1); color: #fff; }
        .sidebar-nav { padding: 20px 16px; flex: 1; }
        .sidebar-item { display: flex; align-items: center; gap: 14px; padding: 14px 16px; border-radius: 12px; cursor: pointer; color: rgba(255,255,255,0.7); font-size: 0.95rem; transition: all 0.2s; margin-bottom: 8px; border: 1px solid transparent; }
        .sidebar-item:hover { color: #fff; background: rgba(255,255,255,0.06); }
        .sidebar-item.active { color: #fff; background: rgba(66,133,244,0.15); border-color: rgba(66,133,244,0.3); }
        .sidebar-item .si-icon { font-size: 1.3rem; width: 28px; text-align: center; }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 30px 20px; }
        .page { display: none; }
        .page.active { display: block; animation: fadeInUp 0.4s ease-out; }
        
        /* Schedule Page */
        header { text-align: center; margin-bottom: 30px; }
        h1 { font-size: 2.5rem; background: linear-gradient(135deg, #4285f4 0%, #34a853 50%, #fbbc04 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px; }
        .subtitle { color: rgba(255,255,255,0.6); font-size: 1rem; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .gemini-badge { background: linear-gradient(135deg, #4285f4, #34a853); color: #fff; padding: 4px 12px; border-radius: 6px; font-weight: 600; font-size: 0.85rem; }
        .legend-panel { display: flex; justify-content: center; gap: 20px; margin-bottom: 30px; flex-wrap: wrap; }
        .legend-item { display: flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.05); padding: 8px 15px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); }
        .legend-dot { width: 10px; height: 10px; border-radius: 50%; }
        .legend-text { font-size: 0.85rem; color: rgba(255,255,255,0.8); }
        .selector-container { display: flex; justify-content: center; margin-bottom: 40px; }
        .class-select { background: rgba(255,255,255,0.1); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.2); border-radius: 12px; padding: 12px 25px; font-size: 1.1rem; color: #fff; cursor: pointer; outline: none; appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 10px center; background-size: 20px; padding-right: 45px; min-width: 200px; transition: all 0.3s; }
        .class-select:hover { border-color: rgba(66,133,244,0.6); box-shadow: 0 0 20px rgba(66,133,244,0.3); }
        .class-select option { background: #1a1f2e; }
        .schedule-grid { display: grid; grid-template-columns: repeat(5,1fr); gap: 15px; }
        @media(max-width:1200px){ .schedule-grid { grid-template-columns: repeat(3,1fr); } }
        @media(max-width:768px){ .schedule-grid { grid-template-columns: 1fr; } }
        .day-card { background: rgba(255,255,255,0.08); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.12); border-radius: 20px; padding: 20px 15px; animation: cardAppear 0.6s ease-out both; }
        .day-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 12px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .day-name { font-size: 1.1rem; font-weight: 600; }
        .day-badge { font-size: 0.6rem; padding: 4px 8px; border-radius: 20px; text-transform: uppercase; white-space: nowrap; }
        .badge-entry { background: linear-gradient(135deg,#4facfe,#00f2fe); color: #0b0f19; }
        .badge-peak { background: linear-gradient(135deg,#f093fb,#f5576c); color: #fff; }
        .badge-relief { background: linear-gradient(135deg,#38ef7d,#11998e); color: #0b0f19; }
        .badge-normal { background: rgba(255,255,255,0.2); color: rgba(255,255,255,0.8); }
        .lesson { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.08); border-radius: 10px; padding: 12px; margin-bottom: 8px; transition: all 0.3s; display: flex; justify-content: space-between; align-items: center; }
        .lesson-content { display: flex; align-items: center; gap: 12px; }
        .lesson-number { font-size: 0.75rem; color: rgba(255,255,255,0.4); width: 15px; }
        .lesson-name { font-size: 0.9rem; font-weight: 500; }
        .difficulty-indicator { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
        .diff-high { background: #ff6b6b; box-shadow: 0 0 8px rgba(255,107,107,0.5); }
        .diff-med { background: #feca57; box-shadow: 0 0 8px rgba(254,202,87,0.5); }
        .diff-low { background: #5cd85c; box-shadow: 0 0 8px rgba(92,216,92,0.5); }
        
        /* AI Page */
        .ai-header { text-align: center; margin-bottom: 40px; }
        .ai-header h2 { font-size: 2.2rem; background: linear-gradient(135deg, #4285f4, #34a853); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; gap: 12px; }
        .ai-header p { color: rgba(255,255,255,0.5); font-size: 1rem; }
        
        .test-builder { max-width: 900px; margin: 0 auto; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 30px; }
        .form-section { margin-bottom: 28px; }
        .form-section-title { font-size: 0.85rem; font-weight: 600; color: rgba(255,255,255,0.5); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 14px; display: flex; align-items: center; gap: 8px; }
        
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px; }
        @media(max-width:768px){ .form-row { grid-template-columns: 1fr; } }
        
        .form-group { margin-bottom: 16px; }
        .form-label { display: block; font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-bottom: 8px; font-weight: 500; }
        .form-input, .form-select { width: 100%; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.15); border-radius: 12px; padding: 12px 16px; color: #fff; font-size: 0.95rem; font-family: inherit; outline: none; transition: all 0.2s; }
        .form-input:focus, .form-select:focus { border-color: rgba(66,133,244,0.6); background: rgba(255,255,255,0.12); box-shadow: 0 0 0 3px rgba(66,133,244,0.1); }
        .form-select option { background: #1a1f2e; }
        .form-input::placeholder { color: rgba(255,255,255,0.3); }
        
        .subject-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; }
        .subject-chip { padding: 12px 16px; border-radius: 12px; font-size: 0.9rem; cursor: pointer; background: rgba(255,255,255,0.06); border: 2px solid rgba(255,255,255,0.1); color: rgba(255,255,255,0.7); transition: all 0.2s; text-align: center; font-weight: 500; }
        .subject-chip:hover { border-color: rgba(66,133,244,0.4); background: rgba(66,133,244,0.08); color: #fff; }
        .subject-chip.selected { background: linear-gradient(135deg, rgba(66,133,244,0.2), rgba(52,168,83,0.2)); border-color: rgba(66,133,244,0.6); color: #fff; box-shadow: 0 4px 12px rgba(66,133,244,0.3); }
        
        .question-types { display: flex; flex-direction: column; gap: 10px; }
        .question-type-item { display: flex; align-items: center; gap: 12px; padding: 14px 16px; background: rgba(255,255,255,0.06); border: 2px solid rgba(255,255,255,0.1); border-radius: 12px; cursor: pointer; transition: all 0.2s; }
        .question-type-item:hover { border-color: rgba(66,133,244,0.4); background: rgba(66,133,244,0.08); }
        .question-type-item.selected { background: linear-gradient(135deg, rgba(66,133,244,0.15), rgba(52,168,83,0.15)); border-color: rgba(66,133,244,0.6); box-shadow: 0 4px 12px rgba(66,133,244,0.2); }
        .qt-checkbox { width: 20px; height: 20px; border-radius: 6px; border: 2px solid rgba(255,255,255,0.3); display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .question-type-item.selected .qt-checkbox { background: #4285f4; border-color: #4285f4; }
        .qt-checkbox::after { content: '‚úì'; color: #fff; font-size: 14px; font-weight: bold; opacity: 0; }
        .question-type-item.selected .qt-checkbox::after { opacity: 1; }
        .qt-label { flex: 1; font-size: 0.95rem; color: rgba(255,255,255,0.8); }
        .question-type-item.selected .qt-label { color: #fff; font-weight: 500; }
        .qt-desc { font-size: 0.8rem; color: rgba(255,255,255,0.4); }
        
        /* Toggle */
        .toggle-container { display: flex; align-items: center; justify-content: space-between; padding: 14px 16px; background: rgba(255,255,255,0.06); border: 2px solid rgba(255,255,255,0.1); border-radius: 12px; cursor: pointer; transition: all 0.2s; }
        .toggle-container:hover { border-color: rgba(66,133,244,0.4); background: rgba(66,133,244,0.08); }
        .toggle-container.active { background: linear-gradient(135deg, rgba(66,133,244,0.15), rgba(52,168,83,0.15)); border-color: rgba(66,133,244,0.6); }
        .toggle-label { flex: 1; font-size: 0.95rem; color: rgba(255,255,255,0.8); font-weight: 500; }
        .toggle-container.active .toggle-label { color: #fff; }
        .toggle-switch { width: 48px; height: 26px; background: rgba(255,255,255,0.15); border-radius: 13px; position: relative; transition: all 0.3s; }
        .toggle-container.active .toggle-switch { background: #4285f4; }
        .toggle-switch::after { content: ''; position: absolute; width: 20px; height: 20px; background: #fff; border-radius: 50%; top: 3px; left: 3px; transition: all 0.3s; }
        .toggle-container.active .toggle-switch::after { left: 25px; }
        
        .generate-btn { width: 100%; padding: 16px; border-radius: 14px; border: none; background: linear-gradient(135deg, #4285f4, #34a853); color: #fff; font-size: 1.05rem; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 10px; }
        .generate-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(66,133,244,0.4); }
        .generate-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-spinner { width: 20px; height: 20px; border: 2px solid rgba(255,255,255,0.3); border-top-color: #fff; border-radius: 50%; animation: spin 0.8s linear infinite; display: none; }
        .generate-btn.loading .btn-spinner { display: block; }
        .generate-btn.loading .btn-text { display: none; }
        
        /* Result */
        .result-container { max-width: 900px; margin: 40px auto 0; background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 30px; display: none; animation: fadeInUp 0.4s ease-out; }
        .result-container.show { display: block; }
        .result-header { display: flex; align-items: center; gap: 14px; margin-bottom: 24px; padding-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.08); }
        .result-avatar { width: 48px; height: 48px; background: linear-gradient(135deg, #4285f4, #34a853, #fbbc04, #ea4335); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3rem; flex-shrink: 0; }
        .result-info h3 { font-size: 1.1rem; margin-bottom: 4px; }
        .result-info p { font-size: 0.85rem; color: rgba(255,255,255,0.5); }
        .result-actions { margin-left: auto; display: flex; gap: 10px; }
        .result-btn { padding: 8px 16px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.15); background: rgba(255,255,255,0.06); color: rgba(255,255,255,0.7); font-size: 0.85rem; cursor: pointer; transition: all 0.2s; white-space: nowrap; }
        .result-btn:hover { background: rgba(255,255,255,0.12); color: #fff; }
        .result-content { font-size: 0.95rem; line-height: 1.8; color: rgba(255,255,255,0.9); white-space: pre-wrap; word-break: break-word; }
        
        .toast { position: fixed; bottom: 30px; right: 30px; background: linear-gradient(135deg, #4285f4, #34a853); color: #fff; padding: 14px 24px; border-radius: 12px; font-size: 0.9rem; font-weight: 500; z-index: 999; box-shadow: 0 8px 25px rgba(66,133,244,0.4); transform: translateY(100px); opacity: 0; transition: all 0.4s cubic-bezier(.4,0,.2,1); }
        .toast.show { transform: translateY(0); opacity: 1; }
        
        footer { text-align: center; margin-top: 60px; padding: 20px; color: rgba(255,255,255,0.3); font-size: 0.85rem; border-top: 1px solid rgba(255,255,255,0.05); }
        footer span { background: linear-gradient(135deg, #4285f4, #34a853); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        /* Print Styles */
        @media print {
            body { background: #fff; color: #000; }
            .bg-gradient, .navbar, .sidebar, .sidebar-overlay, .test-builder, .result-header, .toast, footer { display: none !important; }
            .result-container { max-width: 100%; margin: 0; padding: 20px; background: #fff; border: none; display: block !important; }
            .result-content { color: #000; font-size: 12pt; line-height: 1.6; }
            @page { margin: 2cm; }
        }
        
        @keyframes fadeInUp { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }
        @keyframes cardAppear { from{opacity:0;transform:translateY(40px) scale(0.95)} to{opacity:1;transform:translateY(0) scale(1)} }
        @keyframes spin { to{transform:rotate(360deg)} }
        .schedule-grid.updating .day-card { animation: cardAppear 0.5s ease-out both; }
    </style>
</head>
<body>
<div class="bg-gradient bg-1"></div>
<div class="bg-gradient bg-2"></div>
<div class="bg-gradient bg-3"></div>
<div class="toast" id="toast"></div>

<!-- NAVBAR -->
<nav class="navbar">
    <div class="navbar-inner">
        <div class="nav-logo">
            <div class="gemini-icon"></div>
            <span>AI Schedule</span>
        </div>
        <div class="burger" id="burgerBtn">
            <span></span><span></span><span></span>
        </div>
    </div>
</nav>

<!-- SIDEBAR -->
<div class="sidebar-overlay" id="sidebarOverlay"></div>
<div class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <div class="gemini-icon"></div>
        <div class="sidebar-title">–ú–µ–Ω—é</div>
        <div class="sidebar-close" id="sidebarClose">‚úï</div>
    </div>
    <div class="sidebar-nav">
        <div class="sidebar-item active" data-page="schedule">
            <span class="si-icon">üìÖ</span>
            <div>
                <div style="font-size:.95rem;font-weight:500">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</div>
                <div style="font-size:.75rem;color:rgba(255,255,255,.4);margin-top:2px">–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–Ω—è—Ç–∏–π</div>
            </div>
        </div>
        <div class="sidebar-item" data-page="ai">
            <span class="si-icon">‚ú®</span>
            <div>
                <div style="font-size:.95rem;font-weight:500">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç–æ–≤</div>
                <div style="font-size:.75rem;color:rgba(255,255,255,.4);margin-top:2px">–°–æ–∑–¥–∞–Ω–∏–µ —Å Gemini AI</div>
            </div>
        </div>
    </div>
</div>

<div class="container">

    <!-- SCHEDULE PAGE -->
    <div class="page active" id="page-schedule">
        <header>
            <h1>‚ú® AI Schedule Optimizer</h1>
            <p class="subtitle"><span class="gemini-badge">Gemini AI</span> –£–º–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è —à–∫–æ–ª—ã</p>
        </header>
        <div class="legend-panel">
            <div class="legend-item"><div class="legend-dot diff-high"></div><span class="legend-text">–°–ª–æ–∂–Ω–æ (—Ç–æ—á–Ω—ã–µ –Ω–∞—É–∫–∏)</span></div>
            <div class="legend-item"><div class="legend-dot diff-med"></div><span class="legend-text">–°—Ä–µ–¥–Ω–µ (–≥—É–º–∞–Ω–∏—Ç–∞—Ä–Ω—ã–µ)</span></div>
            <div class="legend-item"><div class="legend-dot diff-low"></div><span class="legend-text">–õ–µ–≥–∫–æ (—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ / —Å–ø–æ—Ä—Ç)</span></div>
        </div>
        <div class="selector-container">
            <select class="class-select" id="classSelect"></select>
        </div>
        <div class="schedule-grid" id="scheduleGrid"></div>
        <footer>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é <span>Gemini AI</span> ‚Ä¢ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–æ—Ä–º–∞–º –°–∞–Ω–ü–∏–ù 2.4.2.2821-10</footer>
    </div>

    <!-- AI PAGE -->
    <div class="page" id="page-ai">
        <div class="ai-header">
            <h2><div class="gemini-icon" style="width:44px;height:44px"></div> –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç–æ–≤ Gemini</h2>
            <p>–°–æ–∑–¥–∞–π —Ç–µ—Å—Ç –ø–æ –ª—é–±–æ–º—É –ø—Ä–µ–¥–º–µ—Ç—É —Å –ø–æ–º–æ—â—å—é –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ Google Gemini</p>
        </div>

        <!-- TEST BUILDER -->
        <div class="test-builder">
            <!-- –ü—Ä–µ–¥–º–µ—Ç –∏ –∫–ª–∞—Å—Å -->
            <div class="form-section">
                <div class="form-section-title">üìö –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–ö–ª–∞—Å—Å</label>
                        <select class="form-select" id="gradeSelect">
                            <option value="">–í—ã–±–µ—Ä–∏ –∫–ª–∞—Å—Å</option>
                            <option value="1">1 –∫–ª–∞—Å—Å</option>
                            <option value="2">2 –∫–ª–∞—Å—Å</option>
                            <option value="3">3 –∫–ª–∞—Å—Å</option>
                            <option value="4">4 –∫–ª–∞—Å—Å</option>
                            <option value="5">5 –∫–ª–∞—Å—Å</option>
                            <option value="6">6 –∫–ª–∞—Å—Å</option>
                            <option value="7">7 –∫–ª–∞—Å—Å</option>
                            <option value="8">8 –∫–ª–∞—Å—Å</option>
                            <option value="9">9 –∫–ª–∞—Å—Å</option>
                            <option value="10">10 –∫–ª–∞—Å—Å</option>
                            <option value="11">11 –∫–ª–∞—Å—Å</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">–¢–µ–º–∞ —É—Ä–æ–∫–∞</label>
                        <input type="text" class="form-input" id="topicInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è">
                    </div>
                </div>
            </div>

            <!-- –ü—Ä–µ–¥–º–µ—Ç -->
            <div class="form-section">
                <div class="form-section-title">üìñ –ü—Ä–µ–¥–º–µ—Ç</div>
                <div class="subject-grid" id="subjectGrid"></div>
            </div>

            <!-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞–Ω–∏–π –∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ -->
            <div class="form-section">
                <div class="form-section-title">üìù –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ—Å—Ç–∞</div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞–Ω–∏–π</label>
                        <input type="number" class="form-input" id="taskCount" min="1" max="50" value="10" placeholder="–í–≤–µ–¥–∏ —á–∏—Å–ª–æ">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</label>
                        <input type="number" class="form-input" id="variantCount" min="1" max="10" value="1" placeholder="–í–≤–µ–¥–∏ —á–∏—Å–ª–æ">
                    </div>
                </div>
            </div>

            <!-- –¢–∏–ø—ã –≤–æ–ø—Ä–æ—Å–æ–≤ -->
            <div class="form-section">
                <div class="form-section-title">üéØ –¢–∏–ø—ã –∑–∞–¥–∞–Ω–∏–π (–≤—ã–±–µ—Ä–∏ –Ω—É–∂–Ω—ã–µ)</div>
                <div class="question-types">
                    <div class="question-type-item" data-type="choice1">
                        <div class="qt-checkbox"></div>
                        <div style="flex:1">
                            <div class="qt-label">1 –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –∏–∑ 4</div>
                            <div class="qt-desc">–¢–µ—Å—Ç —Å –≤—ã–±–æ—Ä–æ–º –æ–¥–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ (A, B, C, D)</div>
                        </div>
                    </div>
                    <div class="question-type-item" data-type="choice2">
                        <div class="qt-checkbox"></div>
                        <div style="flex:1">
                            <div class="qt-label">2 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏–∑ 5</div>
                            <div class="qt-desc">–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä (A, B, C, D, E)</div>
                        </div>
                    </div>
                    <div class="question-type-item" data-type="matching">
                        <div class="qt-checkbox"></div>
                        <div style="flex:1">
                            <div class="qt-label">–°–æ–æ—Ç–Ω–µ—Å–µ–Ω–∏–µ (A-1, B-2)</div>
                            <div class="qt-desc">–°–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –¥–≤—É—Ö –∫–æ–ª–æ–Ω–æ–∫</div>
                        </div>
                    </div>
                    <div class="question-type-item" data-type="open">
                        <div class="qt-checkbox"></div>
                        <div style="flex:1">
                            <div class="qt-label">–†–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç</div>
                            <div class="qt-desc">–ó–∞–¥–∞–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç—ã -->
            <div class="form-section">
                <div class="form-section-title">üîë –û—Ç–≤–µ—Ç—ã</div>
                <div class="toggle-container" id="answersToggle">
                    <div class="toggle-label">–î–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç—ã –∫ —Ç–µ—Å—Ç—É</div>
                    <div class="toggle-switch"></div>
                </div>
            </div>

            <button class="generate-btn" id="generateBtn">
                <div class="btn-spinner"></div>
                <span class="btn-text">‚ú® –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç —Å Gemini</span>
            </button>
        </div>

        <!-- RESULT -->
        <div class="result-container" id="resultContainer">
            <div class="result-header">
                <div class="result-avatar">‚ú®</div>
                <div class="result-info">
                    <h3>Gemini AI</h3>
                    <p id="resultSubtitle">–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω</p>
                </div>
                <div class="result-actions">
                    <button class="result-btn" id="copyResult">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button class="result-btn" id="downloadResult">üíæ –°–∫–∞—á–∞—Ç—å</button>
                    <button class="result-btn" id="printResult">üñ® –ü–µ—á–∞—Ç—å</button>
                </div>
            </div>
            <div class="result-content" id="resultContent"></div>
        </div>
    </div>

</div>

<script>
// ================================================================
//  SCHEDULE DATA
// ================================================================
const FULL_SCHEDULE = {
"1–ê":[["–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–ú–∑"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–§–∑","–ò–ó"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–¢—Ö"],["–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–û–∫"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–§–∑"]],
"1–ë":[["–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–ò–ó"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–§–∑","–ú–∑","–û–∫"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–¢—Ö"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–§–∑"],["–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–û–∫"]],
"2–ê":[["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–¢—Ö"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ò–ó","–ú–∑"],["–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–§–∑"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–û–∫"],["–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–§–∑"]],
"2–ë":[["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–ú–∑"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–§–∑","–û–∫"],["–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ò–ó"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–¢—Ö"],["–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–§–∑"]],
"3–ê":[["–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–û–∫","–§–∑"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ú–∑"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–ò–ó","–¢—Ö"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–§–∑"],["–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ"]],
"3–ë":[["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–¢—Ö","–û–∫"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–§–∑"],["–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–ú–∑","–ò–ó"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–û–∫"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–§–∑","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞"]],
"4–ê":[["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–ú–∑","–ò–ó"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–û–±","–§–∑","–¢—Ö"],["–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–û–ë","–§–∑"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–û–±"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫"]],
"4–ë":[["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–¢—Ö","–ú–∑"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ò–ó","–§–∑"],["–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–û–ë","–û–∫"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–§–∑"],["–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–õ–∏—Ç–µ—Ä.—á—Ç–µ–Ω–∏–µ","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞"]],
"5–ê":[["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ò—Å","–ò–ó","–§–∑"],["–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∑","–ë–∏","–ì–µ"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–¢—Ö","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ò—Å"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–§–∑","–ò—Å","–ë–∏","–û–ë"],["–ì–µ","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∑","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞"]],
"5–ë":[["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ì–µ","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–§–∑","–ò—Å"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ú–∑","–ë–∏","–ò—Å"],["–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–¢—Ö","–ò—Å"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–§–∑","–ì–µ","–ë–∏","–û–ë"],["–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–ò–ó","–§–∑"]],
"6–ê":[["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–ë–∏","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–û–±"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ò—Å","–ì–µ","–ú–∑","–§–∑"],["–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–¢—Ö","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ò–ó"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–§–∑","–ò—Å","–ì–µ","–û–ë"],["–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–û–±","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–§–∑"]],
"6–ë":[["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ì–µ","–ò—Å"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–ë–∏","–ò—Å","–ò–ó","–û–±"],["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∑","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–¢—Ö"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–ò—Å","–§–∑","–ë–∏","–û–ë"],["–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–û–±","–§–∑"]],
"7–ê":[["–ê–ª–≥–µ–±—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ò—Å","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ì–µ","–ë–∏","–§–∑"],["–ì–µ–æ–º–µ—Ç—Ä–∏—è","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–û–±","–ú–∑","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–§–∏","–ò–ó"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–ª–≥–µ–±—Ä–∞","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ò–Ω","–¢—Ö","–§–∏","–û–ë"],["–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ì–µ–æ–º–µ—Ç—Ä–∏—è","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ë–∏","–ì–µ","–ò—Å"],["–ê–ª–≥–µ–±—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ì–µ","–û–±"]],
"7–ë":[["–§–∑","–ê–ª–≥–µ–±—Ä–∞","–ì–µ","–ë–∏","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ú–∑","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫"],["–ê–ª–≥–µ–±—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–§–∏","–ò—Å","–û–±","–ò–ó","–ì–µ"],["–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ì–µ–æ–º–µ—Ç—Ä–∏—è","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ò–Ω","–ë–∏","–ò—Å","–¢—Ö"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–ª–≥–µ–±—Ä–∞","–§–∏","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–û–ë"],["–ì–µ–æ–º–µ—Ç—Ä–∏—è","–û–±","–ê–ª–≥–µ–±—Ä–∞","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–§–∏","–§–∑"]],
"8–ê":[["–ê–ª–≥–µ–±—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–•–∏","–ò—Å","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ë–∏","–û–ë"],["–ì–µ–æ–º–µ—Ç—Ä–∏—è","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–§–∏","–û–±","–ì–µ","–ò–Ω","–¢—Ö"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–ª–≥–µ–±—Ä–∞","–•–∏","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–û–±","–ò—Å","–ë–∏"],["–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ì–µ–æ–º–µ—Ç—Ä–∏—è","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–§–∏","–ì–µ","–§–∑","–ê–ª–≥–µ–±—Ä–∞"],["–ê–ª–≥–µ–±—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ò–Ω","–ì–µ"]],
"8–ë":[["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–ª–≥–µ–±—Ä–∞","–ò—Å","–•–∏","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–¢—Ö","–§–∑"],["–ê–ª–≥–µ–±—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ì–µ","–§–∏","–ë–∏","–ò–Ω","–û–ë"],["–ì–µ–æ–º–µ—Ç—Ä–∏—è","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–•–∏","–û–±","–ò—Å","–ì–µ"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–ª–≥–µ–±—Ä–∞","–§–∏","–ë–∏","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ì–µ–æ–º–µ—Ç—Ä–∏—è","–§–∑"],["–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ê–ª–≥–µ–±—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–û–±","–ò–Ω"]],
"9–ê":[["–ê–ª–≥–µ–±—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–§–∏","–ò—Å","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–•–∏","–§–∑"],["–ì–µ–æ–º–µ—Ç—Ä–∏—è","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ë–∏","–ì–µ","–û–±","–ò–Ω","–û–ë"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–ª–≥–µ–±—Ä–∞","–•–∏","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–§–∏","–ò—Å","–¢—Ö"],["–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ì–µ–æ–º–µ—Ç—Ä–∏—è","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ë–∏","–ì–µ","–û–±","–ò–Ω"],["–ê–ª–≥–µ–±—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–†–æ–¥–Ω–æ–π —è–∑—ã–∫","–§–∏","–§–∑"]],
"9–ë":[["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ì–µ–æ–º–µ—Ç—Ä–∏—è","–•–∏","–§–∏","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ò—Å","–û–ë"],["–ê–ª–≥–µ–±—Ä–∞","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ì–µ","–ë–∏","–ò–Ω","–û–±","–§–∑"],["–ì–µ–æ–º–µ—Ç—Ä–∏—è","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ò—Å","–•–∏","–¢—Ö","–§–∏"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–ª–≥–µ–±—Ä–∞","–ë–∏","–ì–µ","–ò–Ω","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–û–±"],["–ì–µ–æ–º–µ—Ç—Ä–∏—è","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–û–±","–§–∏","–†–æ–¥–Ω–æ–π —è–∑—ã–∫","–ê–ª–≥–µ–±—Ä–∞","–•–∏"]],
"10":[["–ê–ª–≥–µ–±—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ò–Ω","–•–∏","–ò—Å","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ë–∏"],["–ì–µ–æ–º–µ—Ç—Ä–∏—è","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–§–∏","–û–±","–ì–µ","–ò–Ω","–û–ë"],["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–ª–≥–µ–±—Ä–∞","–§–∏","–•–∏","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ò—Å","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞"],["–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ì–µ–æ–º–µ—Ç—Ä–∏—è","–ë–∏","–û–±","–ì–µ","–§–∑","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π"],["–ê–ª–≥–µ–±—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–ì–µ","–•–∏","–†–æ–¥–Ω–æ–π —è–∑—ã–∫","–§–∑"]],
"11":[["–§–∏","–•–∏","–ê–ª–≥–µ–±—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–û–±","–ò–Ω","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π"],["–ë–∏","–ò—Å","–ì–µ–æ–º–µ—Ç—Ä–∏—è","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–§–∑","–û–ë","–ì–µ"],["–ò–Ω","–ë–∏","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ê–ª–≥–µ–±—Ä–∞","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ò—Å","–§–∏"],["–•–∏","–§–∏","–û–±","–ì–µ–æ–º–µ—Ç—Ä–∏—è","–ê–Ω–≥–ª–∏–π—Å–∫–∏–π","–†–æ–¥–Ω–æ–π —è–∑—ã–∫","–§–∑"],["–ì–µ","–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ê–ª–≥–µ–±—Ä–∞","–†—É—Å—Å–∫–∏–π —è–∑—ã–∫","–ë–∏","–ò–Ω","–û–±"]]
};

const expand={"–§–∑":"–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞","–§–∏":"–§–∏–∑–∏–∫–∞","–•–∏":"–•–∏–º–∏—è","–ë–∏":"–ë–∏–æ–ª–æ–≥–∏—è","–ò—Å":"–ò—Å—Ç–æ—Ä–∏—è","–ì–µ":"–ì–µ–æ–≥—Ä–∞—Ñ–∏—è","–û–±":"–û–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ","–ò–Ω":"–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞","–ò–ó":"–ò–ó–û","–ú–∑":"–ú—É–∑—ã–∫–∞","–¢—Ö":"–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è","–û–ë":"–û–ë–ó–†","–û–∫":"–û–∫—Ä. –º–∏—Ä"};
for(const cls in FULL_SCHEDULE){ FULL_SCHEDULE[cls]=FULL_SCHEDULE[cls].map(day=>day.map(s=>expand[s]||s)); }

const daysInfo=[
    {name:"–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",badge:"entry",text:"–í—Ö–æ–¥ –≤ –Ω–µ–¥–µ–ª—é"},
    {name:"–í—Ç–æ—Ä–Ω–∏–∫",badge:"peak",text:"–ü–∏–∫–æ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞"},
    {name:"–°—Ä–µ–¥–∞",badge:"peak",text:"–ü–∏–∫–æ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞"},
    {name:"–ß–µ—Ç–≤–µ—Ä–≥",badge:"normal",text:"–û–±—ã—á–Ω—ã–π –¥–µ–Ω—å"},
    {name:"–ü—è—Ç–Ω–∏—Ü–∞",badge:"relief",text:"–†–∞–∑–≥—Ä—É–∑–æ—á–Ω—ã–π –¥–µ–Ω—å"}
];
const getDiff=s=>{
    if(["–ê–ª–≥–µ–±—Ä–∞","–ì–µ–æ–º–µ—Ç—Ä–∏—è","–§–∏–∑–∏–∫–∞","–•–∏–º–∏—è","–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞"].includes(s))return"high";
    if(["–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞","–ò–ó–û","–ú—É–∑—ã–∫–∞","–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è","–û–ë–ó–†","–û–∫—Ä. –º–∏—Ä"].includes(s))return"low";
    return"med";
};
const orderedClasses=["1–ê","1–ë","2–ê","2–ë","3–ê","3–ë","4–ê","4–ë","5–ê","5–ë","6–ê","6–ë","7–ê","7–ë","8–ê","8–ë","9–ê","9–ë","10","11"];

const renderSchedule=cls=>{
    const grid=document.getElementById('scheduleGrid');
    grid.classList.add('updating');
    grid.innerHTML="";
    (FULL_SCHEDULE[cls]||[]).forEach((lessons,di)=>{
        const d=daysInfo[di];
        let h=`<div class="day-card"><div class="day-header"><span class="day-name">${d.name}</span><span class="day-badge badge-${d.badge}">${d.text}</span></div>`;
        lessons.forEach((s,li)=>{
            const df=getDiff(s);
            h+=`<div class="lesson"><div class="lesson-content"><span class="lesson-number">${li+1}</span><span class="lesson-name">${s}</span></div><div class="difficulty-indicator diff-${df}"></div></div>`;
        });
        grid.innerHTML+=h+`</div>`;
    });
    setTimeout(()=>grid.classList.remove('updating'),300);
};

// NAVIGATION
function switchPage(id){
    document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
    document.querySelectorAll('.sidebar-item').forEach(el=>el.classList.remove('active'));
    document.getElementById('page-'+id).classList.add('active');
    document.querySelectorAll(`[data-page="${id}"]`).forEach(el=>el.classList.add('active'));
    closeSidebar();
}
document.querySelectorAll('.sidebar-item').forEach(t=>t.addEventListener('click',()=>switchPage(t.dataset.page)));

const sidebar=document.getElementById('sidebar');
const overlay=document.getElementById('sidebarOverlay');
const burger=document.getElementById('burgerBtn');
function openSidebar(){sidebar.classList.add('open');overlay.classList.add('open');burger.classList.add('active');}
function closeSidebar(){sidebar.classList.remove('open');overlay.classList.remove('open');burger.classList.remove('active');}
burger.addEventListener('click',()=>sidebar.classList.contains('open')?closeSidebar():openSidebar());
overlay.addEventListener('click',closeSidebar);
document.getElementById('sidebarClose').addEventListener('click',closeSidebar);

// SCHEDULE INIT
document.addEventListener('DOMContentLoaded',()=>{
    const sel=document.getElementById('classSelect');
    orderedClasses.forEach(c=>{
        if(FULL_SCHEDULE[c]){
            const o=document.createElement('option');
            o.value=c;
            o.textContent=isNaN(c[0])?c:c+" –∫–ª–∞—Å—Å";
            if(c==="7–ê")o.selected=true;
            sel.appendChild(o);
        }
    });
    renderSchedule("7–ê");
    sel.addEventListener('change',e=>renderSchedule(e.target.value));
});

// ================================================================
//  AI TEST GENERATOR
// ================================================================
const API_URL = 'https://groq-ai-bot-raj1.onrender.com/generate';

const SUBJECTS = {
    '–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞': 1,
    '–†—É—Å—Å–∫–∏–π —è–∑—ã–∫': 1,
    '–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–µ —á—Ç–µ–Ω–∏–µ': 1,
    '–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞': 5,
    '–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫': 2,
    '–û–∫—Ä—É–∂–∞—é—â–∏–π –º–∏—Ä': 1,
    '–ò—Å—Ç–æ—Ä–∏—è': 5,
    '–û–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ': 6,
    '–ì–µ–æ–≥—Ä–∞—Ñ–∏—è': 5,
    '–ë–∏–æ–ª–æ–≥–∏—è': 5,
    '–§–∏–∑–∏–∫–∞': 7,
    '–•–∏–º–∏—è': 8,
    '–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞': 5,
    '–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞': 1,
    '–ò–ó–û': 1,
    '–ú—É–∑—ã–∫–∞': 1,
    '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è': 1,
    '–û–ë–ó–†': 1
};

let selectedSubject = '';
let selectedTypes = new Set();
let includeAnswers = true; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ

// –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
const subjectGrid = document.getElementById('subjectGrid');
Object.keys(SUBJECTS).forEach(subject=>{
    const chip = document.createElement('div');
    chip.className = 'subject-chip';
    chip.textContent = subject;
    chip.dataset.subject = subject;
    chip.addEventListener('click',()=>{
        document.querySelectorAll('.subject-chip').forEach(c=>c.classList.remove('selected'));
        chip.classList.add('selected');
        selectedSubject = subject;
        validateForm();
    });
    subjectGrid.appendChild(chip);
});

// –¢–∏–ø—ã –≤–æ–ø—Ä–æ—Å–æ–≤
document.querySelectorAll('.question-type-item').forEach(item=>{
    item.addEventListener('click',()=>{
        const type = item.dataset.type;
        if(selectedTypes.has(type)){
            selectedTypes.delete(type);
            item.classList.remove('selected');
        } else {
            selectedTypes.add(type);
            item.classList.add('selected');
        }
        validateForm();
    });
});

// Toggle –æ—Ç–≤–µ—Ç–æ–≤
const answersToggle = document.getElementById('answersToggle');
answersToggle.classList.add('active'); // –í–∫–ª—é—á–µ–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
answersToggle.addEventListener('click',()=>{
    includeAnswers = !includeAnswers;
    answersToggle.classList.toggle('active');
});

// –í–∞–ª–∏–¥–∞—Ü–∏—è
const gradeSelect = document.getElementById('gradeSelect');
gradeSelect.addEventListener('change', validateForm);

function validateForm(){
    const grade = parseInt(gradeSelect.value);
    if(!grade || !selectedSubject) return;
    const minGrade = SUBJECTS[selectedSubject];
    if(grade < minGrade){
        showToast(`‚ö†Ô∏è ${selectedSubject} –∏–∑—É—á–∞–µ—Ç—Å—è —Å ${minGrade} –∫–ª–∞—Å—Å–∞`);
        gradeSelect.value = minGrade;
    }
}

// Toast
function showToast(msg){
    const t=document.getElementById('toast');
    t.textContent=msg;
    t.classList.add('show');
    setTimeout(()=>t.classList.remove('show'),3000);
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è
document.getElementById('generateBtn').addEventListener('click', async ()=>{
    const grade = gradeSelect.value;
    const topic = document.getElementById('topicInput').value.trim();
    const taskCount = document.getElementById('taskCount').value;
    const variantCount = document.getElementById('variantCount').value;
    
    if(!grade){ showToast('‚ö†Ô∏è –í—ã–±–µ—Ä–∏ –∫–ª–∞—Å—Å'); return; }
    if(!selectedSubject){ showToast('‚ö†Ô∏è –í—ã–±–µ—Ä–∏ –ø—Ä–µ–¥–º–µ—Ç'); return; }
    if(!topic){ showToast('‚ö†Ô∏è –í–≤–µ–¥–∏ —Ç–µ–º—É —É—Ä–æ–∫–∞'); return; }
    if(!taskCount || taskCount<1){ showToast('‚ö†Ô∏è –£–∫–∞–∂–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞–Ω–∏–π'); return; }
    if(selectedTypes.size===0){ showToast('‚ö†Ô∏è –í—ã–±–µ—Ä–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ç–∏–ø –∑–∞–¥–∞–Ω–∏–π'); return; }
    
    const btn = document.getElementById('generateBtn');
    btn.disabled = true;
    btn.classList.add('loading');
    showToast('‚è≥ –ì–µ–Ω–µ—Ä–∏—Ä—É—é —Ç–µ—Å—Ç... –≠—Ç–æ –∑–∞–π–º—ë—Ç 10-30 —Å–µ–∫—É–Ω–¥');
    
    try {
        const typesDesc = Array.from(selectedTypes).map(t=>{
            if(t==='choice1') return '—Ç–µ—Å—Ç —Å –æ–¥–Ω–∏–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –æ—Ç–≤–µ—Ç–æ–º –∏–∑ 4 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (—Ñ–æ—Ä–º–∞—Ç: –≤–æ–ø—Ä–æ—Å, –≤–∞—Ä–∏–∞–Ω—Ç—ã A) B) C) D))';
            if(t==='choice2') return '—Ç–µ—Å—Ç —Å –¥–≤—É–º—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏ –∏–∑ 5 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (—Ñ–æ—Ä–º–∞—Ç: –≤–æ–ø—Ä–æ—Å, –≤–∞—Ä–∏–∞–Ω—Ç—ã A) B) C) D) E))';
            if(t==='matching') return '–∑–∞–¥–∞–Ω–∏–µ –Ω–∞ —Å–æ–æ—Ç–Ω–µ—Å–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (—Ñ–æ—Ä–º–∞—Ç: –ª–µ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü A, B, C... –∏ –ø—Ä–∞–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü 1, 2, 3...)';
            if(t==='open') return '–∑–∞–¥–∞–Ω–∏–µ —Å —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–º –æ—Ç–≤–µ—Ç–æ–º';
        }).join('; ');
        
        let prompt = `–°–æ—Å—Ç–∞–≤—å —Ç–µ—Å—Ç –¥–ª—è —É—á–∏—Ç–µ–ª—è –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É ¬´${selectedSubject}¬ª –¥–ª—è ${grade} –∫–ª–∞—Å—Å–∞.\n`;
        prompt += `–¢–µ–º–∞: ¬´${topic}¬ª.\n`;
        prompt += `–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞–Ω–∏–π: ${taskCount}.\n`;
        prompt += `${variantCount > 1 ? `–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤: ${variantCount}.\n` : ''}`;
        prompt += `–¢–∏–ø—ã –∑–∞–¥–∞–Ω–∏–π (–∏—Å–ø–æ–ª—å–∑—É–π –°–¢–†–û–ì–û –¢–û–õ–¨–ö–û —ç—Ç–∏ —Ç–∏–ø—ã): ${typesDesc}.\n\n`;
        
        prompt += `–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:\n`;
        prompt += `‚Äî –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û —Ç–µ —Ç–∏–ø—ã –∑–∞–¥–∞–Ω–∏–π –∫–æ—Ç–æ—Ä—ã–µ —è —É–∫–∞–∑–∞–ª –≤—ã—à–µ\n`;
        prompt += `‚Äî –ù–ï –¥–æ–±–∞–≤–ª—è–π –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã –∑–∞–¥–∞–Ω–∏–π –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ —Å–ø–∏—Å–∫–µ\n`;
        prompt += `‚Äî –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–π –∑–∞–¥–∞–Ω–∏—è –ø–æ —Ç–∏–ø–∞–º —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ\n`;
        if(selectedTypes.has('choice1')) {
            prompt += `‚Äî –î–ª—è –∑–∞–¥–∞–Ω–∏–π "1 –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–∑ 4": –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û 4 –≤–∞—Ä–∏–∞–Ω—Ç–∞ (A, B, C, D), —Ç–æ–ª—å–∫–æ –û–î–ò–ù –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π\n`;
        }
        if(selectedTypes.has('choice2')) {
            prompt += `‚Äî –î–ª—è –∑–∞–¥–∞–Ω–∏–π "2 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏–∑ 5": –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û 5 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (A, B, C, D, E), —Ä–æ–≤–Ω–æ –î–í–ê –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö\n`;
        }
        if(selectedTypes.has('matching')) {
            prompt += `‚Äî –î–ª—è —Å–æ–æ—Ç–Ω–µ—Å–µ–Ω–∏—è: –ª–µ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü (–ê, –ë, –í...), –ø—Ä–∞–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü (1, 2, 3...)\n`;
        }
        if(variantCount > 1) {
            prompt += `‚Äî –°–æ–∑–¥–∞–π ${variantCount} –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ç–µ—Å—Ç–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ –∑–∞–¥–∞–Ω–∏—è–º–∏\n`;
        }
        
        if(includeAnswers) {
            prompt += `‚Äî –í –∫–æ–Ω—Ü–µ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–±–∞–≤—å —Ä–∞–∑–¥–µ–ª "–ö–õ–Æ–ß–ò" –∏–ª–∏ "–û–¢–í–ï–¢–´" —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏ –¥–ª—è –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π\n`;
            if(selectedTypes.has('choice1') || selectedTypes.has('choice2')) {
                prompt += `‚Äî –í –∫–ª—é—á–∞—Ö —É–∫–∞–∂–∏ –Ω–æ–º–µ—Ä –∑–∞–¥–∞–Ω–∏—è –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –±—É–∫–≤—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: 1-B, 2-A –∏ —Ç.–¥.)\n`;
            }
            if(selectedTypes.has('matching')) {
                prompt += `‚Äî –î–ª—è —Å–æ–æ—Ç–Ω–µ—Å–µ–Ω–∏—è –≤ –∫–ª—é—á–∞—Ö –ø–æ–∫–∞–∂–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ê-2, –ë-1, –í-3)\n`;
            }
            if(variantCount > 1) {
                prompt += `‚Äî –û—Ç–≤–µ—Ç—ã –≥—Ä—É–ø–ø–∏—Ä—É–π –ø–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º (–í–∞—Ä–∏–∞–Ω—Ç 1: –æ—Ç–≤–µ—Ç—ã..., –í–∞—Ä–∏–∞–Ω—Ç 2: –æ—Ç–≤–µ—Ç—ã...)\n`;
            }
        } else {
            prompt += `‚Äî –ù–ï –¥–æ–±–∞–≤–ª—è–π –æ—Ç–≤–µ—Ç—ã –∏ –∫–ª—é—á–∏ –∫ –∑–∞–¥–∞–Ω–∏—è–º\n`;
        }
        
        prompt += `‚Äî –ó–∞–¥–∞–Ω–∏—è –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –§–ì–û–° –∏ –≤–æ–∑—Ä–∞—Å—Ç—É ${grade} –∫–ª–∞—Å—Å–∞\n`;
        prompt += `‚Äî –û—Ñ–æ—Ä–º–∏ —á—ë—Ç–∫–æ —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π\n\n`;
        prompt += `–ù–∞—á–Ω–∏ –æ—Ç–≤–µ—Ç —Å: "–ü—Ä–∏–≤–µ—Ç! –Ø –Ω–µ–π—Ä–æ—Å–µ—Ç—å Gemini. –Ø —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∞ –¥–ª—è –≤–∞—Å —Ç–µ—Å—Ç –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É ¬´${selectedSubject}¬ª –¥–ª—è ${grade} –∫–ª–∞—Å—Å–∞ –Ω–∞ —Ç–µ–º—É ¬´${topic}¬ª. –í–æ—Ç —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å:"\n\n`;
        prompt += `–ó–∞—Ç–µ–º —Å—Ä–∞–∑—É –Ω–∞—á–∏–Ω–∞–π —Ç–µ—Å—Ç.`;
        
        const messages = [
            {role: 'system', content: '–¢—ã ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∏–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç Gemini –æ—Ç Google. –ü–æ–º–æ–≥–∞–µ—à—å —É—á–∏—Ç–µ–ª—è–º —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã. –í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—à—å –æ—Ç–≤–µ—Ç —Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –æ—Ç –∏–º–µ–Ω–∏ Gemini. –°–¢–†–û–ì–û —Å–ª–µ–¥—É–π —É–∫–∞–∑–∞–Ω–Ω—ã–º —Ç–∏–ø–∞–º –∑–∞–¥–∞–Ω–∏–π –∏ –ù–ï –¥–æ–±–∞–≤–ª—è–π –ª–∏—à–Ω–∏–µ.'},
            {role: 'user', content: prompt}
        ];
        
        console.log('üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...');
        
        const res = await fetch(API_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ messages: messages })
        });
        
        if(!res.ok){
            throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ${res.status}`);
        }
        
        const data = await res.json();
        const result = data.choices?.[0]?.message?.content || '(–ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç)';
        
        console.log('‚úÖ –û—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω');
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        const resultContainer = document.getElementById('resultContainer');
        const resultContent = document.getElementById('resultContent');
        const resultSubtitle = document.getElementById('resultSubtitle');
        
        const typesText = Array.from(selectedTypes).map(t=>{
            if(t==='choice1') return '1 –∏–∑ 4';
            if(t==='choice2') return '2 –∏–∑ 5';
            if(t==='matching') return '–°–æ–æ—Ç–Ω–µ—Å–µ–Ω–∏–µ';
            if(t==='open') return '–†–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π';
        }).join(', ');
        
        resultSubtitle.textContent = `${selectedSubject}, ${grade} –∫–ª–∞—Å—Å ‚Ä¢ ${taskCount} ${taskCount==1?'–∑–∞–¥–∞–Ω–∏–µ':taskCount<5?'–∑–∞–¥–∞–Ω–∏—è':'–∑–∞–¥–∞–Ω–∏–π'} ‚Ä¢ –¢–∏–ø—ã: ${typesText}${variantCount>1?' ‚Ä¢ '+variantCount+' –≤–∞—Ä.':''}${includeAnswers?' ‚Ä¢ –° –æ—Ç–≤–µ—Ç–∞–º–∏':''}`;
        resultContent.textContent = result;
        resultContainer.classList.add('show');
        resultContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
        
        showToast('‚úÖ –¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω!');
        
    } catch(error) {
        console.error('‚ùå –û—à–∏–±–∫–∞:', error);
        showToast('‚ùå –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: ' + error.message);
    }
    
    btn.disabled = false;
    btn.classList.remove('loading');
});

// –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
document.getElementById('copyResult').addEventListener('click',()=>{
    const text = document.getElementById('resultContent').textContent;
    navigator.clipboard.writeText(text).then(()=>{
        showToast('üìã –¢–µ—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
    }).catch(()=>{
        showToast('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å');
    });
});

// –°–∫–∞—á–∏–≤–∞–Ω–∏–µ DOCX
document.getElementById('downloadResult').addEventListener('click',()=>{
    const text = document.getElementById('resultContent').textContent;
    const blob = new Blob([text], {type: 'text/plain;charset=utf-8'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `test_${selectedSubject}_${gradeSelect.value}kl_${Date.now()}.txt`;
    a.click();
    URL.revokeObjectURL(url);
    showToast('üíæ –¢–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω!');
});

// –ü–µ—á–∞—Ç—å
document.getElementById('printResult').addEventListener('click',()=>{
    window.print();
    showToast('üñ® –û—Ç–∫—Ä—ã—Ç–æ –æ–∫–Ω–æ –ø–µ—á–∞—Ç–∏');
});
</script>
</body>
</html>